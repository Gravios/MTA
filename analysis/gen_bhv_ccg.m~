function  Bccg = gen_bhv_ccg(Session,varargin)
[state,dur_thresh] = DefaultArgs(varargin,{'rear',180});


sper = Session.Bhv.getState(state).state;
sname = Session.Bhv.getState(state).label;


sdur = diff(sper,1,2);
sper = sper(sdur>dur_thresh,:);

Bccg = MTAccg(Session,sname,['CCG around' sname 'and offset'], ...
              {sper(:,1),sper(:,2)},{1,2},{[sname ' onset'],[sname ' offset']});