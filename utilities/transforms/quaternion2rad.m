
function eAng = quaternion2rad(q)
eAng  = horzcat(atan2(2 .* (q(:,1) .* q(:,4) + q(:,2) .* q(:,3)), 1 - 2 .* (q(:,3).^2 + q(:,4).^2)),... Yaw
               asin(2 .* (q(:,1) .* q(:,3) - q(:,4) .* q(:,2))),                                    ... Pitch
               atan2( 2 .* (q(:,1) .* q(:,2) + q(:,3) .* q(:,4)), 1 - 2 .* (q(:,2).^2 + q(:,3).^2))); % Roll
eAng(2 .* (q(:,1) .* q(:,3) - q(:,4) .* q(:,2)) > 1, 2) = pi/2;